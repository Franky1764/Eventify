"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6865],{6865:(N,P,d)=>{d.r(P),d.d(P,{ProfilePageModule:()=>R});var v=d(177),m=d(4341),s=d(4742),b=d(9384),p=d(467),e=d(4438),_=d(4171),E=d(3625),C=d(5143),k=d(9885);let j=(()=>{var r;class n{constructor(t,o,i,l,c,u,f){this.formBuilder=t,this.modalController=o,this.alertController=i,this.utilsSvc=l,this.firebaseSvc=c,this.sqliteService=u,this.userService=f,this.profileForm=this.formBuilder.group({nombre:["",m.k0.required],apellido:["",m.k0.required],edad:["",m.k0.required],whatsapp:["",m.k0.required],carrera:["",m.k0.required],sede:["",m.k0.required],profilePhoto:[""]})}ngOnInit(){this.profile&&this.profileForm.patchValue(this.profile)}save(){var t=this;return(0,p.A)(function*(){if(t.profileForm.valid){const o=yield t.utilsSvc.loading();yield o.present();const i=t.userService.user;if(i&&i.uid){const l=t.profileForm.value;try{yield t.sqliteService.updateUser({...t.profile,...l}),o.dismiss(),console.log("Usuario actualizado"),yield(yield t.alertController.create({header:"\xc9xito",message:"Datos actualizados exitosamente.",buttons:["OK"]})).present(),t.modalController.dismiss(l)}catch(c){o.dismiss(),console.error("Error al actualizar el usuario",c)}}else console.error("No hay usuario logueado")}else console.error("Formulario inv\xe1lido")})()}close(){this.modalController.dismiss()}}return(r=n).\u0275fac=function(t){return new(t||r)(e.rXU(m.ok),e.rXU(s.W3),e.rXU(s.hG),e.rXU(_.T),e.rXU(E.f),e.rXU(C.E),e.rXU(k.D))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-profile-edit"]],inputs:{profile:"profile"},decls:97,vars:1,consts:[["color","orchid"],["slot","end"],["fill","clear","color","light",3,"click"],[3,"ngSubmit","formGroup"],["position","floating"],["type","text","formControlName","nombre","required",""],["type","text","formControlName","apellido","required",""],["type","number","formControlName","edad","required",""],["type","tel","formControlName","whatsapp","required",""],["formControlName","carrera"],["value","Analista Programador"],["value","Ingenier\xeda en Inform\xe1tica"],["value","Desarrollo de Aplicaciones"],["value","Ingenier\xeda en Desarrollo de Software"],["value","Ingenier\xeda en Infraestructura Tecnol\xf3gica"],["value","Ingenier\xeda en Redes y Telecommunicaciones"],["value","Inform\xe1tica Biom\xe9dica"],["value","Otra Carrera"],["formControlName","sede"],["value","Alameda"],["value","Alonso de Ovalle"],["value","Antonio Varas"],["value","Campus Arauco"],["value","Campus Nacimiento"],["value","Campus Villarrica"],["value","Maipu"],["value","Melipilla"],["value","Plaza Norte"],["value","Plaza Oeste"],["value","Plaza Vespucio"],["value","Puente Alto"],["value","Puerto Montt"],["value","San Andres de Concepcion"],["value","San Bernardo"],["value","San Carlos de Apoquindo"],["value","San Joaquin"],["value","Valparaiso"],["value","Vina del Mar"],["expand","block","type","submit",1,"custom-button"],["expand","block","color","medium",1,"custom-button",3,"click"]],template:function(t,o){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3,"Editar Perfil"),e.k0s(),e.j41(4,"ion-buttons",1)(5,"ion-button",2),e.bIt("click",function(){return o.close()}),e.EFF(6,"Cerrar"),e.k0s()()()(),e.j41(7,"ion-content")(8,"form",3),e.bIt("ngSubmit",function(){return o.save()}),e.j41(9,"ion-item")(10,"ion-label",4),e.EFF(11,"Nombre"),e.k0s(),e.nrm(12,"ion-input",5),e.k0s(),e.j41(13,"ion-item")(14,"ion-label",4),e.EFF(15,"Apellido"),e.k0s(),e.nrm(16,"ion-input",6),e.k0s(),e.j41(17,"ion-item")(18,"ion-label",4),e.EFF(19,"Edad"),e.k0s(),e.nrm(20,"ion-input",7),e.k0s(),e.j41(21,"ion-item")(22,"ion-label",4),e.EFF(23,"Whatsapp"),e.k0s(),e.nrm(24,"ion-input",8),e.k0s(),e.j41(25,"ion-item")(26,"ion-label",4),e.EFF(27,"Carrera"),e.k0s(),e.j41(28,"ion-select",9)(29,"ion-select-option",10),e.EFF(30,"Analista Programador"),e.k0s(),e.j41(31,"ion-select-option",11),e.EFF(32,"Ingenier\xeda en Inform\xe1tica"),e.k0s(),e.j41(33,"ion-select-option",12),e.EFF(34,"Desarrollo de Aplicaciones"),e.k0s(),e.j41(35,"ion-select-option",13),e.EFF(36,"Ingenier\xeda en Desarrollo de Software"),e.k0s(),e.j41(37,"ion-select-option",11),e.EFF(38,"Ingenier\xeda en Inform\xe1tica"),e.k0s(),e.j41(39,"ion-select-option",14),e.EFF(40,"Ingenier\xeda en Infraestructura Tecnol\xf3gica"),e.k0s(),e.j41(41,"ion-select-option",15),e.EFF(42,"Ingenier\xeda en Redes y Telecomunicaciones"),e.k0s(),e.j41(43,"ion-select-option",16),e.EFF(44,"Inform\xe1tica Biom\xe9dica"),e.k0s(),e.j41(45,"ion-select-option",17),e.EFF(46,"Otra"),e.k0s()()(),e.j41(47,"ion-item")(48,"ion-label",4),e.EFF(49,"Sede"),e.k0s(),e.j41(50,"ion-select",18)(51,"ion-select-option",19),e.EFF(52,"Alameda"),e.k0s(),e.j41(53,"ion-select-option",20),e.EFF(54,"Alonso de Ovalle"),e.k0s(),e.j41(55,"ion-select-option",21),e.EFF(56,"Antonio Varas"),e.k0s(),e.j41(57,"ion-select-option",22),e.EFF(58,"Campus Arauco"),e.k0s(),e.j41(59,"ion-select-option",23),e.EFF(60,"Campus Nacimiento"),e.k0s(),e.j41(61,"ion-select-option",24),e.EFF(62,"Campus Villarrica"),e.k0s(),e.j41(63,"ion-select-option",25),e.EFF(64,"Maip\xfa"),e.k0s(),e.j41(65,"ion-select-option",26),e.EFF(66,"Melipilla"),e.k0s(),e.j41(67,"ion-select-option",27),e.EFF(68,"Plaza Norte"),e.k0s(),e.j41(69,"ion-select-option",28),e.EFF(70,"Plaza Oeste"),e.k0s(),e.j41(71,"ion-select-option",29),e.EFF(72,"Plaza Vespucio"),e.k0s(),e.j41(73,"ion-select-option",30),e.EFF(74,"Puente Alto"),e.k0s(),e.j41(75,"ion-select-option",31),e.EFF(76,"Puerto Montt"),e.k0s(),e.j41(77,"ion-select-option",32),e.EFF(78,"San Andr\xe9s de Concepci\xf3n"),e.k0s(),e.j41(79,"ion-select-option",33),e.EFF(80,"San Bernardo"),e.k0s(),e.j41(81,"ion-select-option",34),e.EFF(82,"San Carlos de Apoquindo"),e.k0s(),e.j41(83,"ion-select-option",35),e.EFF(84,"San Joaqu\xedn"),e.k0s(),e.j41(85,"ion-select-option",36),e.EFF(86,"Valparaiso"),e.k0s(),e.j41(87,"ion-select-option",37),e.EFF(88,"Vi\xf1a del Mar"),e.k0s()()(),e.j41(89,"ion-grid")(90,"ion-row")(91,"ion-col")(92,"ion-button",38),e.EFF(93," Guardar "),e.k0s()(),e.j41(94,"ion-col")(95,"ion-button",39),e.bIt("click",function(){return o.close()}),e.EFF(96,"Cancelar"),e.k0s()()()()()()),2&t&&(e.R7$(8),e.Y8G("formGroup",o.profileForm))},dependencies:[s.Jm,s.QW,s.hU,s.W9,s.lO,s.eU,s.$w,s.uz,s.he,s.ln,s.Nm,s.Ip,s.BC,s.ai,s.su,s.Je,s.Gw,m.qT,m.BC,m.cb,m.YS,m.j4,m.JD],styles:["ion-item.custom-item[_ngcontent-%COMP%]{--inner-padding-start: 10px;--inner-padding-end: 10px;margin-bottom:15px;border-radius:10px;box-shadow:0 4px 6px #0000001a}ion-button.custom-button[_ngcontent-%COMP%]{--background: linear-gradient(45deg, #B583FF, #D4A5FF, #FF77FF);--color: white;--border-radius: 20px;--padding-start: 10px;--padding-end: 10px;--padding-top: 8px;--padding-bottom: 8px;font-size:14px;font-weight:600;width:150px;margin:0 auto;box-shadow:0 4px 6px #0003}ion-button.custom-button[_ngcontent-%COMP%]:hover{--background: linear-gradient(45deg, #D4A5FF, #FF77FF, #B583FF);box-shadow:0 6px 10px #0000004d}ion-grid[_ngcontent-%COMP%]{margin-top:20px}body[_ngcontent-%COMP%]{font-family:Poppins,sans-serif}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:600}p[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:300}"]}),n})();var h=d(5083),g=function(r){return r.Prompt="PROMPT",r.Camera="CAMERA",r.Photos="PHOTOS",r}(g||{}),F=function(r){return r.Rear="REAR",r.Front="FRONT",r}(F||{}),x=function(r){return r.Uri="uri",r.Base64="base64",r.DataUrl="dataUrl",r}(x||{});class y extends h.E_{getPhoto(n){var a=this;return(0,p.A)(function*(){return new Promise(function(){var t=(0,p.A)(function*(o,i){if(n.webUseInput||n.source===g.Photos)a.fileInputExperience(n,o,i);else if(n.source===g.Prompt){let l=document.querySelector("pwa-action-sheet");l||(l=document.createElement("pwa-action-sheet"),document.body.appendChild(l)),l.header=n.promptLabelHeader||"Photo",l.cancelable=!1,l.options=[{title:n.promptLabelPhoto||"From Photos"},{title:n.promptLabelPicture||"Take Picture"}],l.addEventListener("onSelection",function(){var c=(0,p.A)(function*(u){0===u.detail?a.fileInputExperience(n,o,i):a.cameraExperience(n,o,i)});return function(u){return c.apply(this,arguments)}}())}else a.cameraExperience(n,o,i)});return function(o,i){return t.apply(this,arguments)}}())})()}pickImages(n){var a=this;return(0,p.A)(function*(){return new Promise(function(){var t=(0,p.A)(function*(o,i){a.multipleFileInputExperience(o,i)});return function(o,i){return t.apply(this,arguments)}}())})()}cameraExperience(n,a,t){var o=this;return(0,p.A)(function*(){if(customElements.get("pwa-camera-modal")){const i=document.createElement("pwa-camera-modal");i.facingMode=n.direction===F.Front?"user":"environment",document.body.appendChild(i);try{yield i.componentOnReady(),i.addEventListener("onPhoto",function(){var l=(0,p.A)(function*(c){const u=c.detail;null===u?t(new h.I9("User cancelled photos app")):u instanceof Error?t(u):a(yield o._getCameraPhoto(u,n)),i.dismiss(),document.body.removeChild(i)});return function(c){return l.apply(this,arguments)}}()),i.present()}catch{o.fileInputExperience(n,a,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),o.fileInputExperience(n,a,t)})()}fileInputExperience(n,a,t){let o=document.querySelector("#_capacitor-camera-input");const i=()=>{var l;null===(l=o.parentNode)||void 0===l||l.removeChild(o)};o||(o=document.createElement("input"),o.id="_capacitor-camera-input",o.type="file",o.hidden=!0,document.body.appendChild(o),o.addEventListener("change",l=>{const c=o.files[0];let u="jpeg";if("image/png"===c.type?u="png":"image/gif"===c.type&&(u="gif"),"dataUrl"===n.resultType||"base64"===n.resultType){const f=new FileReader;f.addEventListener("load",()=>{if("dataUrl"===n.resultType)a({dataUrl:f.result,format:u});else if("base64"===n.resultType){const T=f.result.split(",")[1];a({base64String:T,format:u})}i()}),f.readAsDataURL(c)}else a({webPath:URL.createObjectURL(c),format:u}),i()}),o.addEventListener("cancel",l=>{t(new h.I9("User cancelled photos app")),i()})),o.accept="image/*",o.capture=!0,n.source===g.Photos||n.source===g.Prompt?o.removeAttribute("capture"):n.direction===F.Front?o.capture="user":n.direction===F.Rear&&(o.capture="environment"),o.click()}multipleFileInputExperience(n,a){let t=document.querySelector("#_capacitor-camera-input-multiple");const o=()=>{var i;null===(i=t.parentNode)||void 0===i||i.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",i=>{const l=[];for(let c=0;c<t.files.length;c++){const u=t.files[c];let f="jpeg";"image/png"===u.type?f="png":"image/gif"===u.type&&(f="gif"),l.push({webPath:URL.createObjectURL(u),format:f})}n({photos:l}),o()}),t.addEventListener("cancel",i=>{a(new h.I9("User cancelled photos app")),o()})),t.accept="image/*",t.click()}_getCameraPhoto(n,a){return new Promise((t,o)=>{const i=new FileReader,l=n.type.split("/")[1];"uri"===a.resultType?t({webPath:URL.createObjectURL(n),format:l,saved:!1}):(i.readAsDataURL(n),i.onloadend=()=>{const c=i.result;t("dataUrl"===a.resultType?{dataUrl:c,format:l,saved:!1}:{base64String:c.split(",")[1],format:l,saved:!1})},i.onerror=c=>{o(c)})})}checkPermissions(){var n=this;return(0,p.A)(function*(){if(typeof navigator>"u"||!navigator.permissions)throw n.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw n.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var n=this;return(0,p.A)(function*(){throw n.unimplemented("Not implemented on web.")})()}pickLimitedLibraryPhotos(){var n=this;return(0,p.A)(function*(){throw n.unavailable("Not implemented on web.")})()}getLimitedLibraryPhotos(){var n=this;return(0,p.A)(function*(){throw n.unavailable("Not implemented on web.")})()}}new y;const w=(0,h.F3)("Camera",{web:()=>new y});var M=d(2872),I=d(5588);function A(r,n){if(1&r&&e.nrm(0,"img",11),2&r){const a=e.XpG();e.Y8G("src",a.user.profilePhoto,e.B4B)}}function O(r,n){1&r&&e.nrm(0,"img",12)}function S(r,n){if(1&r&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3),e.k0s()(),e.j41(4,"ion-card-content")(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s(),e.j41(9,"p"),e.EFF(10),e.k0s(),e.j41(11,"p"),e.EFF(12),e.k0s()()()),2&r){const a=e.XpG();e.R7$(3),e.Lme("",a.user.nombre," ",a.user.apellido,""),e.R7$(3),e.SpI("Edad: ",a.user.edad,""),e.R7$(2),e.SpI("Whatsapp: +56 ",a.user.whatsapp,""),e.R7$(2),e.SpI("Carrera: ",a.user.carrera,""),e.R7$(2),e.SpI("Sede: ",a.user.sede,"")}}const U=[{path:"",component:(()=>{var r;class n{constructor(t,o,i,l,c,u){this.userService=t,this.sqliteService=o,this.firebaseService=i,this.navCtrl=l,this.modalController=c,this.appComponent=u}ngOnInit(){var t=this;return(0,p.A)(function*(){t.user=t.userService.user,t.user||(yield t.userService.loadUser(),t.user=t.userService.user)})()}takePhoto(){var t=this;return(0,p.A)(function*(){const o=yield w.getPhoto({quality:90,allowEditing:!1,resultType:x.DataUrl,source:g.Prompt});if(o&&t.user){const i=yield t.firebaseService.uploadImage(o.dataUrl,`profilePhotos/${t.user.uid}.jpg`);yield t.userService.updateProfilePhoto(t.user.uid,i),t.user.profilePhoto=i,yield t.sqliteService.updateUser(t.user)}})()}goBack(){this.navCtrl.back()}openEditModal(){var t=this;return(0,p.A)(function*(){if(t.user){const o=yield t.modalController.create({component:j,componentProps:{profile:t.user}});return o.onDidDismiss().then(function(){var i=(0,p.A)(function*(l){l.data&&(t.userService.user=l.data,yield t.userService.loadUser(),t.user=t.userService.user)});return function(l){return i.apply(this,arguments)}}()),yield o.present()}console.error("No user found")})()}logout(){this.appComponent.onLogout()}}return(r=n).\u0275fac=function(t){return new(t||r)(e.rXU(k.D),e.rXU(C.E),e.rXU(E.f),e.rXU(M.q9),e.rXU(s.W3),e.rXU(I.Z))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-profile"]],decls:27,vars:3,consts:[["defaultImage",""],[1,"ion-justify-content-center"],["size","12",1,"ion-text-center"],["alt","Foto de perfil",3,"src",4,"ngIf","ngIfElse"],["fill","clear","color","secondary",1,"camera-button",3,"click"],["name","camera-outline"],[4,"ngIf"],["shape","round",1,"custom-button",3,"click"],["expand","block","color","medium",1,"custom-button",3,"click"],[1,"welcome-section"],["src","assets/img/bienvenida.png","alt","Gatita saludando",1,"welcome-image"],["alt","Foto de perfil",3,"src"],["src","assets/img/profile.png","alt","Foto de perfil por defecto"]],template:function(t,o){if(1&t){const i=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Perfil"),e.k0s()()(),e.j41(4,"ion-content")(5,"ion-grid")(6,"ion-row",1)(7,"ion-col",2)(8,"ion-avatar"),e.DNE(9,A,1,1,"img",3)(10,O,1,0,"ng-template",null,0,e.C5r),e.k0s(),e.j41(12,"ion-button",4),e.bIt("click",function(){return e.eBV(i),e.Njj(o.takePhoto())}),e.nrm(13,"ion-icon",5),e.k0s()()()(),e.DNE(14,S,13,6,"ion-card",6),e.j41(15,"ion-grid")(16,"ion-row")(17,"ion-col")(18,"ion-button",7),e.bIt("click",function(){return e.eBV(i),e.Njj(o.openEditModal())}),e.EFF(19,"Editar Perfil"),e.k0s()(),e.j41(20,"ion-col")(21,"ion-button",8),e.bIt("click",function(){return e.eBV(i),e.Njj(o.logout())}),e.EFF(22,"Cerrar Sesi\xf3n"),e.k0s()()()(),e.j41(23,"div",9),e.nrm(24,"img",10),e.j41(25,"h3"),e.EFF(26,"Me alegra verte por aqu\xed"),e.k0s()()()}if(2&t){const i=e.sdS(11);e.R7$(9),e.Y8G("ngIf",o.user&&o.user.profilePhoto)("ngIfElse",i),e.R7$(5),e.Y8G("ngIf",o.user)}},dependencies:[v.bT,s.mC,s.Jm,s.b_,s.I9,s.ME,s.tN,s.hU,s.W9,s.lO,s.eU,s.iq,s.ln,s.BC,s.ai],styles:["ion-avatar[_ngcontent-%COMP%]{width:120px;height:120px;margin:20px auto;position:relative}.camera-button[_ngcontent-%COMP%]{position:absolute;top:100px;right:0;font-size:18px;color:#8a2be2}.custom-item[_ngcontent-%COMP%]{--background: #e8dff1;border-radius:10px;margin-bottom:12px;--padding-start: 16px}ion-label[_ngcontent-%COMP%]{font-size:14px;color:#666}ion-select[_ngcontent-%COMP%]{--padding-start: 0px;--text-align: right;font-size:12px;color:#333}ion-item.ion-focused[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%]{font-size:12px;color:#8a2be2}.preferences-card[_ngcontent-%COMP%]{--background: #e8dff1;border-radius:10px;padding:12px}ion-button[_ngcontent-%COMP%]{margin-top:12px}.welcome-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:20px}.welcome-section[_ngcontent-%COMP%]   .welcome-image[_ngcontent-%COMP%]{max-width:150px;height:auto;margin-bottom:10px;border-radius:10px}.welcome-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;color:#6a0dad;font-weight:600}ion-button.custom-button[_ngcontent-%COMP%]{--background: linear-gradient(45deg, #B583FF, #D4A5FF, #FF77FF);--color: white;--border-radius: 20px;--padding-start: 10px;--padding-end: 10px;--padding-top: 8px;--padding-bottom: 8px;font-size:14px;font-weight:600;width:150px;margin:0 auto;box-shadow:0 4px 6px #0003}ion-button.custom-button[_ngcontent-%COMP%]:hover{--background: linear-gradient(45deg, #D4A5FF, #FF77FF, #B583FF);box-shadow:0 6px 10px #0000004d}ion-grid[_ngcontent-%COMP%]{margin-top:20px}"]}),n})()}];let D=(()=>{var r;class n{}return(r=n).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[b.iI.forChild(U),b.iI]}),n})(),R=(()=>{var r;class n{}return(r=n).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[v.MD,m.YN,s.bv,D]}),n})()}}]);